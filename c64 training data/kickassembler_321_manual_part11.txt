# KickAssembler - Macros, Functions, Pseudo Commands

function. You can either supply no arguments or give the init values of all the variables. You use
the values generated by structures as any other variables, ex:
           lda #0
           ldy #p1.y
           sta charset+[p1.x>>3]*height,y
                                                                                                     28
6 Branching and Looping
Kick Assembler has control directives that let you put conditions on when a directive is executed
and how many time it is executed. These are explained in this chapter.
6.1 Boolean Values
The conditions for control directives are given by Boolean values, which are values that can be true
or false. They are generated and used as in programming languages like Java and C#. The
following are examples of boolean variables:
   .var myBoolean1 = true                 // Set the variable to true
   .var myBoolean2 = false                // Set the variable to false
   .var fourHigherThanFive = 4>5          // Sets fourHigherThanFive = false
   .var aEqualsB = a==b                   // Sets true if a is the same as b
   .var xNot10 = x!=10                    // Sets true if x doesn’t equal 10
Here is the standard set of operators for generating Booleans:
Name           Operator Example Description
               ==            a==b
Equal                                   Returns true if a equals b, otherwise false
               !=            a!=b
Not Equal                               Returns true if a doesn’t equal b, otherwise false
               >             a>b
Greater                                 Returns true if a is greater than b, otherwise false
               <             a<b
Less                                    Returns true if a is less than b, otherwise false
               >=            a>=b
Greater than                            Returns true if a is greater than or equal to b, otherwise false
               <=            a<=b
Less than                               Returns true if a is less or equal to b, otherwise false.
All the operators are defined for numeric values, other values have defined a subset of the above.
E.g. you can’t say that one boolean is greater than another, but you can see if they have the same
values:
   .var b1 = true==true                   // Sets b1 to true
   .var b2 = true!=[10<20]                // Sets b2 to false
Boolean values have a set of operators assigned. These are the following:
Name      Operator Example Description
Not       !           !a          Returns true if a is false, otherwise false
And       &&          a&&b        Returns true if a and b are true, otherwise false
Or        ||          A||b        Returns true if a or b are true, otherwise false
   .var allTrue = 10HigherThan100 && aEqualsB // Is true if the two boolean
                                                           // arguments are true.
6.2 .if
If-directives work like in standard programming languages. With an .if directive you have the
proceeding directive executed only if a given boolean expression is evaluated to true. Here are
some examples:
                                                                                                      29
  // Set x to 10 if x is higher that 10
  .if (x>10) .eval x=10
  // Only show rastertime if the ‘showRasterTime’ boolean is true
  .var showRasterTime = false
  .if (showRasterTime) inc $d020
  jsr PlayMusic
  .if (showRasterTime) dec $d020
You can group several statements together in a block with {…} and have them executed together if
the boolean expression is true:
  // If IrqNr is 3 then play the music
  .if (irqNr==3) {
          inc $d020
          jsr music+3
          dec $d020
  }
By adding an else statement you can have an expression executed if the boolean expression is false:
  // Add the x’th entry of a table if x is positive or
  // subtract it if x is negative
  .if (x>=0) adc zpXtable+x else sbc zpXtable+abs(x)
  // Init an offset table or display a warning if the table length is exceeded
  .if (i<tableLength) {
      lda #0
      sta offset1+i
      sta offset2+i
  } else {
      .error “Error!! i is too high!”
  }
6.3 Questionmark if’s
As known from languages like Java and C++ you can use the write compact if expression in the
following form:
  condition ? trueExpr : falseExpr
Some examples of use:
  .var x= true ? “hello” : “goodbye”                 // Sets x = “hello”
  .var y= (20<10) ? 1 : 2                            // Sets y=2
  .var max = a>b ? a:b
  .var debug=true
  inc debug ? $d020:$d013              // Increases $d020 since debug=true
  .var limitedX = max(x,minLimit==null?0:minLimit) // Takes care of null limit
                                                                                                 30
6.4 .for
With the .for directive you can generate loops as in modern programming languages. The .for
directive takes an init expression list, a boolean expression, and an iteration list separated by a
semicolon. The last two arguments and the body are executed as long as the boolean expression
evaluates to true.
   // Prints the numbers from 0 to 9
   .for(var i=0;i<10;i++) .print “Number ” + i
   // Make data for a sine wave
   .for(var i=0;i<256;i++) .byte round(127.5+127.5*sin(toRadians(360*i/256)))
Since argument 1 and 3 are lists, you can leave them out, or you can write several expressions
separated by comma:
   // Print the numbers from 0 to 9
   .var i=0
