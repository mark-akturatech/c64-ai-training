# RS-232 Baud-Rate Prescaler Table (NTSC) — CIA #2 timers

**Summary:** NTSC RS-232 prescaler table used by CIA #2 timer-driven NMI routines; contains prescaler values for standard baud rates (50–2400). Includes the formula ((CLOCK/BAUD)/2)-100 and notes NTSC clock 1,022,730 Hz vs PAL 985,250 Hz (separate PAL table referenced).

**Description**

This chunk documents the RS-232 baud-rate prescaler table used on NTSC (U.S. television standard) Commodore machines. The prescalers are used by CIA #2 timer interrupts to generate the bit timing for RS-232 I/O handled by NMI-driven routines.

- **Purpose:** Ten prescaler values corresponding to ten standard baud-rate settings implemented by the RS-232 Control Register (referenced as entry 659 / $293 in the original listing). The table begins with the two values for the lowest baud rate (50 baud) and ends with entries for the highest baud rate (2400 baud).
- **Timing rationale:** Because an RS-232 device can both receive and send a bit within a single interrupt cycle, the interval between interrupts should be slightly less than half of (CLOCK / BAUD). The exact reload value used for the CIA timer is computed as:
  \[
  \text{PRESCALER} = \left( \frac{\text{CLOCK}}{\text{BAUD}} \right) / 2 - 100
  \]
  where CLOCK is the processor clock in cycles per second, and BAUD is the target serial baud rate.
- **Clock rates:**
  - NTSC (U.S.): CLOCK = 1,022,730 Hz
  - PAL (Europe): CLOCK = 985,250 Hz
  Because of the different clock frequencies, a separate PAL prescaler table exists (referenced at address 58604 / $E4EC in the source).
- **Implementation notes:** The RS-232 routines are invoked from NMI interrupts generated by CIA #2 timers. The prescaler values in the table are loaded (as timer reloads/prescale values) to achieve the target baud timing per the formula above.

## Source Code

The following table lists the prescaler values for standard baud rates on NTSC systems:

```text
Baud Rate | Prescaler Value (Hex)
---------------------------------
50        | 4A50
75        | 3544
110       | 2452
134.5     | 1DB0
150       | 1AA2
300       | 0D52
600       | 06A8
1200      | 0354
1800      | 0238
2400      | 01AA
```

These values are stored in memory starting at address 65218 ($FEC2) for NTSC systems. For PAL systems, the corresponding table is located at address 58604 ($E4EC).

To load a prescaler value into the CIA #2 timer registers, the following steps are performed:

1. **Select the desired baud rate:** Determine the index of the baud rate in the prescaler table. For example, for 300 baud, the index is 5 (starting from 0).

2. **Retrieve the prescaler value:** Read the two-byte prescaler value from the table at $FEC2 + (index * 2). For 300 baud:
   - Low byte: $FEC2 + (5 * 2) = $FEC2 + $0A = $FECC
   - High byte: $FECC + 1 = $FECD

3. **Load the prescaler value into the timer registers:**
   - Store the low byte into Timer A Low Byte register ($DD04).
   - Store the high byte into Timer A High Byte register ($DD05).

4. **Configure and start the timer:**
   - Set the appropriate control bits in the Timer A Control Register ($DD0E) to start the timer in the desired mode.

Example assembly code to set up Timer A for 300 baud:

```assembly
    LDX #5                  ; Index for 300 baud
    LDA $FEC2,X             ; Load low byte of prescaler
    STA $DD04               ; Store to Timer A Low Byte
    LDA $FEC3,X             ; Load high byte of prescaler
    STA $DD05               ; Store to Timer A High Byte
    LDA #%00010001          ; Set control bits: start timer, continuous mode
    STA $DD0E               ; Store to Timer A Control Register
```

## Key Registers

- $DD00-$DD0F - CIA #2 - timers, interrupt control, and RS-232 timing sources (CIA #2 timers generate NMIs used by the RS-232 routines)

## References

- "nmi_rs232_handler" — NMI-driven RS-232 handling (uses these prescalers for timing)
- "rs232_receive_next_bit_nmi" — receive routine driven by NMI and timing from the baud-rate table