# Kick Assembler: Importing .prg Files and Segment Min/Max Fill Behavior

**Summary:** Explains Kick Assembler's `.segment`/`.segmentdef` `prgFiles` parameter and the `.import c64` workflow (placing `.prg` contents after an explicit `*=` address), and how segment `min`/`max` with `fill`/`fillByte` controls generated bytes and size enforcement.

**Importing .prg Files**

Two common ways to include existing `.prg` files into a Kick Assembler build:

- **`.segmentdef` with `prgFiles` Parameter:**
  - Use the `.segmentdef` declaration with the `prgFiles` parameter to have Kick Assembler include one or more `.prg` files as memory blocks for that segment.
  - **Example:**
  - The listed `.prg` files are combined into the segment according to the assembler's placement rules for that segment.

- **`.import c64` After Setting `*=`:**
  - Place an explicit location (using `*=`) and then import a raw `.prg` file with the `c64` import mode so the `.prg`'s payload is placed starting at the current location. This method gives explicit control over where the `.prg` body is emitted.
  - **Example Pattern:**
  - **Syntax:**
    - `<filename>`: Path to the `.prg` file.
    - `<offset>` (optional): Number of bytes to skip from the start of the file.
    - `<length>` (optional): Number of bytes to import after the offset.
  - **Example with Offset and Length:**
    This imports 512 bytes starting from position $402 (the two extra bytes are because it's a `.prg` file). ([theweb.dk](https://theweb.dk/KickAssembler/webhelp/content/ch03s09.html?utm_source=openai))

**Notes:**

- `.prg` files include two address bytes (load address) that count toward any max-size limits you apply to a segment. If you restrict a segment to N bytes and import a `.prg`, those two bytes are included in the size accounting.
- Use `.segment` parameters like `outPrg` to produce an output `.prg` for the segment.

**Segment Min/Max and Fill/FillByte**

- When a segment declares a `min` and `max` (`min=$nnnn`, `max=$mmmm`), the assembler will reserve that address range. Any addresses inside that range that are not explicitly assigned values by your code/data are filled with the fill byte.
- By default, the fill byte is `0x00`; you can set a different fill with the `fillByte` parameter in the segment declaration.
- Restricting a segment's size with `min`/`max` is useful to avoid overlapping ROM areas or to enforce size limits (for example, 128- or 256-byte limits used in demos/competitions).
- **Important:** The `min`/`max` limit is absolute; imported `.prg` files still count their two address bytes against the `max`.

**Example Behavior:**

- The following segment produces bytes at `$1000..$1007` of: `0,0,1,2,3,0,0,0`
- The fill byte can be changed with `fillByte` (e.g., `fillByte=$FF`), so unused bytes inside `min..max` will be `0xFF` instead of `0x00`.

**Examples**

- **Inline `.segmentdef` with `prgFiles`:**

- **Controlled Placement Using `*=` and `.import c64`:**

- **Example Showing Fill Behavior (Default Fill = `$00`):**

- **Example Segment Used for a Size-Limited 128-Byte Competition Entry (Note: `max` Includes the Two `.prg` Address Bytes):**

## Source Code

    ```asm
    .segmentdef Misc1 [prgFiles="data/Music.prg, data/Charset2x2.prg"]
    ```

    ```asm
    *= $1000
    .import c64 "data/Music.prg"   ; place prg contents starting at $1000
    ```

    ```asm
    .import c64 "<filename>", [<offset>], [<length>]
    ```

    ```asm
    .import c64 "charset.c64", $400, $200
    ```

  ```asm
  .segment Data [min=$1000, max=$1008, fill]
  *= $1002
  .byte 1,2,3
  ```

  ```asm
  .segmentdef Misc1 [prgFiles="data/Music.prg, data/Charset2x2.prg"]
  ```

  ```asm
  *= $1000
  .import c64 "data/Music.prg"   ; place prg contents starting at $1000
  ```

  ```asm
  ; This will generate $1000: 0,0,1,2,3,0,0,0
  .segment Data [min=$1000, max=$1008, fill]
  *= $1002
  .byte 1,2,3
  ```

  ```asm
  ; 90 degree rotated ROM font in 69 bytes of code
  .segment Main [min=$0801, max=$0880-2, outPrg="out.prg"]
  .label SCREEN = $400
  .label CHARGEN = $d000
  ```


```asm
.segmentdef Misc1 [prgFiles="data/Music.prg, data/Charset2x2.prg"]
```

```asm
; This will generate $1000: 0,0,1,2,3,0,0,0
.segment Data [min=$1000, max=$1008, fill]
*=$1002
.byte 1,2,3
```

```asm
; Using .import c64 after setting origin
*=$1000
.import c64 "data/Music.prg"
```

```asm
; 90 degree rotated ROM font in 69 bytes of code
.segment Main [min=$0801, max=$0880-2, outPrg="out.prg"]
.label SCREEN = $400
.label CHARGEN = $d000
```

## References

- "including_other_segments" â€” expands on combining imported blocks with other segments and placement rules.

## Labels
- SCREEN
- CHARGEN
