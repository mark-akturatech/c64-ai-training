# byRiclianll - Notes that the DOS converts five 8-bit GCR bytes back to four 8-bit data bytes on read. Gives the formula for calculating the number of 8-bit GCR bytes recorded: (Number of 8-bit data bytes / 4) * 5, explaining how GCR expansion affects recorded size.


Four  normal  8-bit  bytes  are  always  written  to  diskette  as  five  8-bit  GCR  bytes  by  the 
DOS.  The  1541  converts  these  same  five  8-bit  GCR  bytes  back  to  four  normal  8-bit  bytes 
during  a  read.  The  steps  outlined  above  still  apply  but  they  are  performed  in  the  reverse 
order.  (The  appendix  contains  various  mathematical  conversion  routines  for  your  use.) 

In  light  of  the  above  discussion,  we  need  to  recalculate  the  number  of  bytes  that  are 
actually  recorded  in  a  sector.  We  stated  in  Chapter  3  that  a  header  block  was  comprised 
of  eight  8-bit  bytes  excluding  the  header  gap.  This  is  recorded  on  the  diskette  as  ten 
8-bit  GCR  bytes.  The  formula  for  determining  the  actual  number  of  bytes  that  are  re- 
corded is: 

Number  of  8-bit  GCR  Bytes  Recorded  =  (Number  of  8-bit  Data  Bytes/4)  *  5 


116 


---
Additional information can be found by searching:
- "gcr_packing_four_bytes_into_five_gcr_bytes_example" which expands on Practical example demonstrating the 4â†’5 byte packing that leads to the formula
- "sector_byte_expansion_examples_and_block_byte_counts" which expands on Applies the formula to header/data blocks to compute actual on-disk sizes
