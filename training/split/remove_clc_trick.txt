# 6502 Multiplication and Division Algorithms - Source: llx.com - Micro-optimization to remove CLC from the loop by decrementing NUM1 once before the loop and using ADC NUM1 instead of CLC/ADC NUM1; code: LDA #$80; STA RESULT; ASL A; DEC NUM1; loop LSR NUM2; BCC L2; ADC NUM1; L2 ROR A; ROR RESULT; BCC L1; STA RESULT+1. Notes cost of initial DEC and break-even (useful if NUM2 has at least three 1-bits).

A little more trickery can get the CLC out of the loop,
saving 2 cycles per 1-bit in NUM2:


LDA #$80     ;Preload sentinel bit into RESULT
        STA RESULT
        ASL A        ;Initialize RESULT hi byte to 0
	DEC NUM1
L1      LSR NUM2     ;Get low bit of NUM2
        BCC L2       ;0 or 1?
        ADC NUM1     ;If 1, add (NUM1-1)+1
L2      ROR A        ;"Stairstep" shift (catching carry from add)
        ROR RESULT
        BCC L1       ;When sentinel falls off into carry, we're done
        STA RESULT+1


Since the initial DEC NUM1 costs 5 cycles (if
NUM1 is in page 0), this is a win if NUM2 has
at least three 1-bits.


---
Additional information can be found by searching:
- "need_for_speed_and_sentinel_multiply_optimization" which expands on builds on sentinel optimization
