# CA65 Assembler - Structs and Unions (Overview and Declaration)

15. Structs and unions
15.1 Structs and unions Overview
Structs and unions are special forms of scopes. They are, to some degree, comparable to their C counterparts. Both have a list of members. Each member allocates storage, and optionally may have a name.

Each named member has a constant value equal to the storage offset from the beginning of the structure. In the case of a union, all members are placed at the same offset, typically 0.

Each named member also has a storage size which can be accessed with the .SIZEOF operator. The struct or union itself also has a .SIZEOF indicating its total storage size.

15.2 Declaration
Here is an example for a very simple struct with two members and a total size of 4 bytes:

      .struct Point
              xcoord  .word
              ycoord  .word
      .endstruct
A union shares the total space between all its members; its size is the same as that of the largest member. The offset of all members relative to the union is zero.

      .union  Entry
              index   .word
              ptr     .addr
      .endunion
A struct or union may not necessarily have a name. If it is anonymous, no local scope is opened; the identifiers used to name the members are placed into the current scope instead.

Storage allocators may contain a multiplier. A struct may also contain members and definitions of local structs/unions. Example:


      .struct Circle
              .struct Point
                      .word   2         ; Allocate two words
              .endstruct
              Radius  .word
      .endstruct
In this example the size of the Circle struct is 6 (three words).

15.3 The storage allocator keywords

.BYTE, .RES
Allocates multiples of 1 byte. .RES requires an operand.

.DBYT, .WORD, .ADDR
Allocates multiples of 2 bytes.

.FARADDR
Allocates multiples of 3 bytes.

.DWORD
Allocates multiples of 4 bytes.

.TAG
Allocates a previously defined struct.

.STRUCT, .UNION
Begins a nested .struct or .union definition, and allocates it. Note that its member offset values will begin at 0, unless this nested structure is anonymous, in which case they will instead become members of the enclosing scope.

15.4 The .ORG keyword
The .ORG keyword changes the offset value that is assigned to subsequent member names. It's useful when using a struct to define the names of the registers in an I/O chip. Example:
