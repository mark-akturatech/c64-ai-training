# KickAssembler - File Output, Command Line Args, 3D Calculations

           inx
           bne !loop-
           jmp *
   .pc = $0c00               .fill picture.getScreenRamSize(), picture.getScreenRam(i)
   .pc = $1c00 colorRam: .fill picture.getColorRamSize(), picture.getColorRam(i)
   .pc = $2000               .fill picture.getBitmapSize(), picture.getBitmap(i)
Notice how easy it is to reallocate the screen and color ram by combining the .pc and .fill
directives. To avoid typing in format types too often, Kick Assembler has some build in constants
you can use:
Binary format constant                 Blocks                           Description
BF_C64FILE                                                              A C64 file (The two first bytes
                                                                        are skipped)
BF_BITMAP_SINGLECOLOR                  ColorRam,                        The Bitmap single color format
                                       ScreenRam,                       outputted from Timanthes.
                                                                                                       44
                                     Bitmap
BF_KOALA                             Bitmap,                         Files from Koala Paint
                                     ScreenRam,
                                     ColorRam,
                                     BackgroundColor
BF_FLI                               ColorRam,                       Files from Blackmails FLI
                                     ScreenRam,                      editor.
                                     Bitmap
So if you want to load a FLI picture, just write
   .var fliPicture = LoadBinary(“GreatPicture”, BF_FLI)
The formats were chosen so they cover the outputs of Timanthes (NB. Timanthes doesn’t save the
background color in koala format, so if you use that you will get an overflow error). If you feel that
some formats are missing, then send their format strings to me and I will include them in future
versions of Kick Assembler.
TIP: If you want to know how data is placed in the above formats, just print the constant to the
console while assembling. Example: .print “Koala format=”+BF_KOALA
9.6 Import of SID Files
The script language knows the format of SID files. This means that you can import files directly
from the HVSC (High Voltage Sid Collection) which uses this format. To do this you use the
LoadSid function which returns a value that represents the sidfile.
   .var music = LoadSid("C:/c64/HVSC_44-all-of-them/C64Music/Tel_Jeroen/Closing_In.sid")
From this you can extract data such as the init address, the play address, info about the music and
the song data.
Attribute/Function                                  Description
Header                                              The sid file type (PSID or RSID)
Version                                             The header version
location                                            The location of the song
Init                                                The address of the init routine
Play                                                The address of the play routine
Songs                                               The number of songs
startSong                                           The default song
Name                                                A string containing the name of the module
Author                                              A string containing the name of the author
Copyright                                           A string containing copyright information
Speed                                               The speed flags (Consult the Sid format for
                                                    details)
Flags                                               flags (Consult the Sid format for detals)
Startpage                                           Startpage (Consult the Sid format for detals)
Pagelength                                          Pagelength (Consult the Sid format for detals)
                                                                                                    45
Size                                            The data size in bytes
getData(n)                                      Returns the n’th byte of the module. Use this
                                                function together with the size variable to store
                                                the modules binary data into the memory.
Here is an example of use:
  //---------------------------------------------------------
  //---------------------------------------------------------
  //                       SID Player
  //---------------------------------------------------------
  //---------------------------------------------------------
  .var music = LoadSid("Nightshift.sid")
  :BasicUpstart2(start)
  start:
                           lda #$00
                           sta $d020
                           sta $d021
                           ldx #0
                           ldy #0
                           lda #music.startSong-1
                           jsr music.init
                           sei
                           lda #<irq1
                           sta $0314
                           lda #>irq1
                           sta $0315
                           asl $d019
                           lda #$7b
                           sta $dc0d
                           lda #$81
                           sta $d01a
                           lda #$1b
                           sta $d011
                           lda #$80
                           sta $d012
                           cli
  this: jmp this
  //---------------------------------------------------------
  irq1:
                           asl $d019
                           inc $d020
                           jsr music.play
                           dec $d020
                           pla
                           tay
                           pla
                           tax
                           pla
                           rti
  //---------------------------------------------------------
  .pc=music.location "Music"
  .fill music.size, music.getData(i)
  //----------------------------------------------------------
  // Print the music info while assembling
  .print ""
  .print "SID Data"
  .print "--------"
  .print "location=$"+toHexString(music.location)
  .print "init=$"+toHexString(music.init)
  .print "play=$"+toHexString(music.play)
                                                                                                 46
   .print "songs="+music.songs
   .print "startSong="+music.startSong
   .print "size=$"+toHexString(music.size)
   .print "name="+music.name
   .print "author="+music.author
   .print "copyright="+music.copyright
   .print ""
   .print "Additional tech data"
   .print "--------------------"
   .print "header="+music.header
   .print "header version="+music.version
   .print "flags="+toBinaryString(music.flags)
   .print "speed="+toBinaryString(music.speed)
   .print "startpage="+music.startpage
   .print "pagelength="+music.pagelength
Assembling the above code will create a musicplayer for the given sidfile and print the information
in the music file while assembling:
     SID Data
     --------
     location=$1000
     init=$1d70
     play=$1003
     songs=1.0
     startSong=1.0
     size=$d78
