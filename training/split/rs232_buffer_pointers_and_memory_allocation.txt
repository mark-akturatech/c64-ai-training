# - Fully Commented Commodore 64 KERNAL ROM Disassembly (English, "CBM") - OPN050â€“OPN060: set up internal buffer pointers (RIDBE->RIDBS, RODBE->RODBS), allocate memory for RIBUF/ROBUF by calling GETTOP to obtain MEMSIZ, adjust buffer pointer bytes if buffers not already allocated, set SEC to signal top-of-memory change, load a marker and JMP SETTOP to apply the new top-of-memory.

                                ; SET UP BUFFER POINTERS (DBE=DBS)
                                ;
.,F45C AD 9B 02 LDA $029B       OPN050 LDA RIDBE
.,F45F 8D 9C 02 STA $029C              STA RIDBS
.,F462 AD 9E 02 LDA $029E              LDA RODBE
.,F465 8D 9D 02 STA $029D              STA RODBS
                                ;
                                ; ALLOCATE BUFFERS
                                ;
.,F468 20 27 FE JSR $FE27       OPN055 JSR GETTOP      ;GET MEMSIZ
.,F46B A5 F8    LDA $F8                LDA RIBUF+1     ;IN ALLOCATION...
.,F46D D0 05    BNE $F474              BNE OPN060      ;ALREADY
.,F46F 88       DEY                    DEY             ;THERE GOES 256 BYTES
.,F470 84 F8    STY $F8                STY RIBUF+1
.,F472 86 F7    STX $F7                STX RIBUF
.,F474 A5 FA    LDA $FA         OPN060 LDA ROBUF+1     ;OUT ALLOCATION...
.,F476 D0 05    BNE $F47D              BNE MEMTCF      ;ALREAY
.,F478 88       DEY                    DEY             ;THERE GOES 256 BYTES
.,F479 84 FA    STY $FA                STY ROBUF+1
.,F47B 86 F9    STX $F9                STX ROBUF
.,F47D 38       SEC             MEMTCF SEC             ;SIGNAL TOP OF MEMORY CHANGE
.,F47E A9 F0    LDA #$F0               LDA #$F0
.,F480 4C 2D FE JMP $FE2D              JMP SETTOP      ;TOP CHANGED
                                ;

---
Additional information can be found by searching:
- "cln232_cleanup_and_port_setup" which expands on CLN232 is used earlier in OPN232 to initialize port/NMI state before buffer allocation
