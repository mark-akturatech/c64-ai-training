# CA65 Assembler - Pseudo Variables (.ISIZE .PARAMCOUNT .TIME .VERSION)

  
The dilemma:

The original design of this feature was made under the assumption, that any "higher" CPU will support the entire instruction set of the "lower" CPU. For example: the WDC W65C02 supports all instructions of the 65C02, which again support all instructions of the 65SC02. Unfortunately this is not true for all CMOS CPUs - when the 65CE02 was made, some instructions were changed, and a new addressingmode was added. As a result all CPUS after (and including) 65CE02 are no more (source code) compatible with all instructions originally introduced by the 65SC02.

Because of this, the .CPU function and the ISET* macros were repurposed to indicate groups of instructions only, ie only the set of instructions that was added by that particular CPU. In the value returned by .CPU only the bits will be set, that refer to the groups of instructions that are completely supported by that CPU.

The advantage of this is, that the mechanism keeps working for all new CPUs added. The inevitable disadvantage is that you now have to know exactly which CPU added which instructions (look here for reference).


        .if (.cpu .bitand CPU_ISET_65SC02)
                ; This will be assembled for the W65C02, 65C02, 65SC02, 65816, HUC6820
                lda     (c_sp)
        .elseif (.cpu .bitand CPU_ISET_65CE02)
                ; This will be assembled for the 65CE02, 4510, 45GS02
                ldz     #$00
                lda     (c_sp),z
        .else
                ldy     #$00
                lda     (c_sp),y
        .endif
See also: .CAP, which is a similar mechanism, but without the problem outlined above.

9.4 .ISIZE
Reading this pseudo variable will return the current size of the Index register in bits.

For the 65816 instruction set .ISIZE will return either 8 or 16, depending on the current size of the operand in immediate index addressing mode.

For all other CPU instruction sets, .ISIZE will always return 8.

See also: .ASIZE

9.5 .PARAMCOUNT
This builtin pseudo variable is only available in macros. It is replaced by the actual number of parameters that were given in the macro invocation.

Example:


        .macro  foo     arg1, arg2, arg3
        .if     .paramcount <> 3
        .error  "Too few parameters for macro foo"
        .endif
        ...
        .endmacro
  
See section Macros.

9.6 .TIME
Reading this pseudo variable will give a constant integer value that represents the current time in POSIX standard (as seconds since the Epoch).

It may be used to encode the time of translation somewhere in the created code.

Example:


        .dword  .time   ; Place time here
  
9.7 .VERSION
Reading this pseudo variable will give the assembler version according to the following formula:

(VER_MAJOR * 0x100) + VER_MINOR

The upper 8 bits are the major-, the lower 8 bits are the minor version.

Example:

For example, version 47.11 of the assembler would have this macro defined as 0x2f0b.

Note: until 2.19 this pseudo variable was defined as (VER_MAJOR * 0x100) + VER_MINOR * 0x10 - which resulted in broken values starting at version 2.16 of the assembler. For this reason the value of this pseudo variable is considered purely informal - you should not use it to check for a specific assembler version and use different code according to the detected version - please update your code to work with the recent version of the assembler instead (There is very little reason to not use the most recent version - and even less to support older versions in your code).

