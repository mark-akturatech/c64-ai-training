# byRiclianll - Steps for recovering a scratched (scratched file entry in directory) file using the EDIT TRACK & SECTOR utility: load the program, enter track 18 and the sector from the table, choose starting byte 00 (first four files) or 80 (last four), examine the hex dump to find the filename and the file-type byte (00 meaning scratched) and overwrite it with the correct file-type value. Includes the file-type value table listing file types PRG, SEQ, REL, USR, DEL and their corresponding numeric values, plus a recommendation to practice these steps on a test diskette (SAVE, SCRATCH, then recover).

STEP  2.  Load  and  run  the  EDIT  TRACK  &  SECTOR  program  on  the  diskette  with 
the  scratched  file.  When  asked  for  the  track  and  sector,  enter  track  18  and 
the  sector  number  you  read  from  the  table.  When  prompted  for  the  starting 
byte,  enter  00  if  the  scratched  file  entry  was  one  of  the  first  four  files  in  the 
group.  Enter  an  80  if  the  scratched  file  was  displayed  among  the  last  four  in 
the  group. 

STEP  3.  When  the  hex  dump  of  the  half-sector  is  displayed,  cursor  over  to  the  third 
column  of  hexadecimal  numbers  on  the  display.  Next  locate  the  name  of  the 
file  in  the  ASCII  display  on  the  right-hand  side  of  the  screen.  Move  the  cur- 
sor down  until  it  is  on  the  same  line  as  the  start  of  the  file  name.  If  you  have 
done  things  correctly  you  should  be  on  a  row  labeled  with  a  $00,  $20,  $40,  $60, 
$80,  $A0,  $C0,  or  $E0.  The  byte  under  the  cursor  should  be  a  00.  This  is  the 
file-type  byte.  The  00  indicates  a  scratched  file.  Type  over  the  00  value  with 
the  value  that  corresponds  to  the  correct  file  type  as  indicated  below. 


File  Type  Value 


STEP  4.  Hold  down  the  SHIFT  key  and  press  the  CLR/HOME  key.  This  will  terminate 
the  edit  mode.  When  asked  whether  to  rewrite  this  track  and  sector,  press 
Y  and  the  modified  sector  will  be  written  to  the  diskette  in  a  few  seconds. 

STEP  5.  Load  and  list  the  directory  to  see  if  the  file  name  now  appears.  If  it  does  not. 


you  made  a  mistake  and  things  may  have  gone  from  bad  to  worse.  Hopefully, 
the  file  will  be  listed. 


STEP  6.  VALIDATE  the  diskette  by  entering  in  direct  mode: 
OPEN   15,8, 15, "V0":CL0SE15 


If  the  drive  stops  and  the  error  light  is  not  flashing,  everything  has  gone  according  to 
plan  and  the  file  has  been  recovered  successfully.  (If  the  VALIDATE  command  failed, 
see  sections  8.2  and  8.3.) 


PRG 
SEQ 
REL 
USR 
DEL 


82 
81 
84 
83 
80 


174 


NOTE:  It  is  a  good  idea  to  practice  these  steps  on  a  test  diskette  before  you  attempt 
to  recover  your  lost  Accounts  Receivable!  To  do  this:  SAVE  a  file  to  disk,  SCRATCH 
it,  and  follow  the  steps  outlined  above. 


---
Additional information can be found by searching:
- "track18_directory_sector_table" which expands on Sector lookup table referenced when entering the sector number
- "recovering_unclosed_file" which expands on If recovering a PRG or other file type, follow further link-fixing steps discussed elsewhere
