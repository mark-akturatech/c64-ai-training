# MACHINE - PHA/PLA: push and pull accumulator A to/from stack for temporary storage. PHP/PLP: push/pull processor status flags, useful to save condition flags across operations. Examples and usage recommendations (e.g., save/restore flags around delayed action). Note both affect stack pointer by one byte each.


Within the BASIC environment, the stack pointer starts around $FA (the first
item will go into the stack at address $01FA), and goes down from there.
When the stack pointer goes below about $40, BASIC will signal OUT OF MEMORY.
That's over 160 available locations on the stack, plenty of room for most
applications.


PHA (push A) and PLA (pull A)
-----------------------------

How may we use the stack?  Suppose we have a value in the A register and in a
moment we will want to use it.  First we need to print something, and the
character to be printed must be loaded into the A register.  How can we put
away the value in A and bring it back later?  We could slip it into another
register with a transfer function (TAX or TAY) and bring it back from there;
or, we could store it into memory and load it back.  Alternatively, we could
PUSH the A register (PHA) to the stack and PULL (PLA) the value back later.

                                                                        :114:

Again, let's do an example.  Suppose the A register contains 5, and the stack
pointer is at $F3.  If the program says PHA, the value 5 is stored at address
$01F3, and the stack pointer changes to $F2.  Later in the program, we
encounter the instruction PLA:  the stack pointer moves back to $F3 and the
value 5 is read from address $01F3 and placed into the A register.

It's a handy way to put away a value in A for a moment.


PHP (push processor status) and PLP

Sometimes when we are writing a program, we want to test for a condition now
but act on the result of that test later.  We can arrange to do this by
putting the flags away for the time being, and then bringing them back when
we want to test the flags.  We use the instruction PHP (push the processor
status word) to place all the flags on the stack, and PLP (pull the processor
status word) to restore the flags to the status register (SR).

Why would we need to do this?  Perhaps an example will illustrate.  Suppose
we are reading a file of customer purchases, and as we input a data item, we
discover that this is the last one--it's the end of the file.  That means
that we want to close the file and summarize the customer's activity--though
not just yet.  First, we must handle the item of information that we have
input.  So we can "stack" our end-of-file information, handle the last record
in the same way as the previous records, then bring back the status to wee
whether it's time to close the file and print the totals.  We'll be using the
PHPH and PLP for exactly this kind of task in the next chapter.

PHA and PHP both put exactly one item onto the stack; PLA and PLP pull one
item.  There are other commands that handle more than one stack location.


---
Additional information can be found by searching:
- "stack_overview" which expands on general stack behavior and best practices
