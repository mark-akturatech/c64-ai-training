# byRiclianll - Routine to read the BAM (block availability map) from the disk into memory and verify DOS version. Issues a DOS read (M-R) to fetch BAM blocks into a BAM* string, concatenates them, derives DOS version from the BAM contents, and handles failures by printing DOS version or 'failed' and exiting.



91 


320  REM  BAM 

330  PR I NT# 15," M-R " CHR* ( O ) CHR*  <  7 ) CHR$  < 1 92 
) 

340  FOR I =070191 

350  GET#15,B$ 

360   I FB*= " " THENB*=CHR*  <  O ) 

370  BAM*=BAM*+B* 

380  NEXTI 

390  DOS= ABC ( M I D* ( BAM* ,3,1)) 
400  IFD0S=65G0T0460 
410  CL0SE15 

420  PRINT"  <: down:  73,  CBM  DOS  V2- 6  1541,00, 
00" 

430  PRINT" CDOWNJ <:rvs>failed<:roff> " 

440  END 

---
Additional information can be found by searching:
- "user_prompts_and_drive_check" which expands on invoked after the initial DOS drive query
- "buffer_init_certify_loop_and_restore_bam" which expands on this stored BAM image is later used/restored to work around a block-allocate bug
- "annotated_line_range_summary" which expands on explains why the BAM is stored (lines 330-380) and restored (800-890)
